<style>
    @keyframes fluxoLinha { 0% { stroke-dashoffset: 0; } 100% { stroke-dashoffset: -20; } }
    @keyframes pulseDestaque { 0%, 100% { transform: scale(1); box-shadow: var(--sombra-md); } 50% { transform: scale(1.05); box-shadow: 0 0 0 8px rgba(180, 83, 9, 0.3), var(--sombra-xl); } }
    @keyframes fadeInSlide {
  0% {
    opacity: 0;
    transform: translateY(-10px);
  }
  100% {
    opacity: 1;
    transform: translateY(0);
  }
}
    @keyframes pulseHierarquia { 0%, 100% { opacity: 0.3; } 50% { opacity: 0.8; } }
    @keyframes pulsePonto { 0%, 100% { box-shadow: 0 0 0 0 rgba(101, 163, 13, 0.5); } 50% { box-shadow: 0 0 0 8px rgba(101, 163, 13, 0); } }

    .linha-padrao, .linha-hierarquia-setor, .linha-hierarquia-projeto, .linha-hierarquia, .linha-vinculo, .linha-dependencia { fill: none; stroke-linejoin: round; stroke-linecap: round; transition: stroke-width 0.3s cubic-bezier(0.4, 0, 0.2, 1), stroke 0.3s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s ease; }
    .linha-hierarquia-setor { stroke: var(--cor-linha-setor); stroke-width: 3; opacity: 0.85; }
    .linha-hierarquia-setor:hover { stroke-width: 5; opacity: 1; filter: drop-shadow(0 0 4px var(--cor-linha-setor)); }
    .linha-hierarquia-projeto { stroke: var(--cor-linha-projeto); stroke-width: 2.5; opacity: 0.8; }
    .linha-hierarquia-projeto:hover { stroke-width: 4; opacity: 1; filter: drop-shadow(0 0 3px var(--cor-linha-projeto)); }
    
    .linha-hierarquia { stroke: var(--cor-linha-etapa); stroke-width: 2.5; opacity: 0.8; stroke-dasharray: none; }
    .linha-hierarquia:hover { stroke-width: 4; opacity: 1; filter: drop-shadow(0 0 3px var(--cor-linha-etapa)); }

    .linha-vinculo { stroke: var(--cor-primaria); stroke-width: 2.5; opacity: 0.8; stroke-dasharray: 6, 3; animation: fluxoLinha 2s linear infinite; pointer-events: stroke; cursor: pointer; }
    .linha-vinculo:hover { stroke-width: 4; opacity: 1; stroke: var(--cor-perigo); stroke-dasharray: 0; animation: none; filter: drop-shadow(0 0 4px var(--cor-perigo)); }
    .linha-dependencia { stroke: var(--cor-primaria-clara); stroke-width: 2; opacity: 0.7; stroke-dasharray: 4, 4; animation: fluxoLinha 1s linear infinite; pointer-events: stroke; cursor: pointer; }
    .linha-dependencia:hover { stroke-width: 3.5; opacity: 1; stroke: var(--cor-perigo); stroke-dasharray: 0; animation: none; }
    .seta-dependencia { fill: var(--cor-primaria); opacity: 0.7; }
    .linha-temporaria { fill: none; stroke: var(--cor-sucesso); stroke-width: 2.5; stroke-dasharray: 8, 4; opacity: 0.8; pointer-events: none; }

    /* ========== CARD DE SETOR - TEMA TERROSO ========== */
    .card-setor {
      position: absolute;
      width: 300px;
      background: linear-gradient(145deg, #44403c 0%, #292524 100%);
      border-radius: 16px;
      padding: 0;
      overflow: hidden;
      box-shadow: 0 10px 40px rgba(41, 37, 36, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.08);
      z-index: var(--z-cards);
      cursor: move;
      border: 1px solid rgba(217, 119, 6, 0.2);
      transition: all 0.3s ease;
    }
    .card-setor:hover {
      transform: translateY(-4px);
      box-shadow: 0 16px 50px rgba(41, 37, 36, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.1);
      border-color: rgba(217, 119, 6, 0.4);
    }
    .card-setor::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #d97706, #b45309, #92400e);
    }
    .card-setor.arrastando {
      opacity: 0.95;
      z-index: var(--z-arrastando);
      box-shadow: 0 20px 60px rgba(41, 37, 36, 0.5);
    }
    .setor-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 16px 16px 12px;
      background: rgba(0, 0, 0, 0.15);
      border-bottom: 1px solid rgba(255, 255, 255, 0.06);
    }
    .setor-titulo {
      display: flex;
      align-items: center;
      gap: 10px;
      font-weight: 600;
      font-size: 0.95rem;
      color: #fef3c7;
    }
    .setor-titulo i {
      font-size: 1.2rem;
      color: #d97706;
      filter: drop-shadow(0 0 4px rgba(217, 119, 6, 0.4));
    }
    .setor-acoes {
      display: flex;
      gap: 6px;
    }
    .setor-acoes button {
      background: rgba(255, 255, 255, 0.06);
      border: 1px solid rgba(255, 255, 255, 0.1);
      color: #e7e5e4;
      border-radius: 8px;
      padding: 6px 8px;
      cursor: pointer;
      transition: all 0.2s ease;
      font-size: 0.8rem;
    }
    .setor-acoes button:hover {
      background: rgba(217, 119, 6, 0.2);
      border-color: rgba(217, 119, 6, 0.3);
      color: #d97706;
    }
    .btn-setor-toggle.ativo {
      background: var(--cor-primaria) !important;
      color: white !important;
      border-color: var(--cor-primaria) !important;
    }
    /* Gerente do Setor */
    .setor-gerente {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px 16px;
      margin: 0;
      background: rgba(217, 119, 6, 0.1);
      border-bottom: 1px solid rgba(255, 255, 255, 0.06);
      font-size: 0.8125rem;
      color: #e7e5e4;
    }
    .setor-gerente i {
      color: #d97706;
      font-size: 0.9rem;
    }
    .setor-gerente .sem-responsavel {
      color: #a8a29e;
      font-style: italic;
    }
    .btn-editar-gerente {
      margin-left: auto;
      background: rgba(255, 255, 255, 0.08);
      border: none;
      color: #a8a29e;
      cursor: pointer;
      padding: 4px 6px;
      border-radius: 4px;
      transition: all 0.2s ease;
    }
    .btn-editar-gerente:hover {
      background: rgba(217, 119, 6, 0.2);
      color: #d97706;
    }
    /* Resumo do Setor */
    .setor-resumo {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 8px 12px;
      padding: 12px 16px;
      font-size: 0.75rem;
      color: #a8a29e;
    }
    .setor-resumo span {
      display: flex;
      justify-content: space-between;
    }
    .setor-resumo span b {
      color: #fef3c7;
      font-weight: 600;
    }
    /* Lista de Projetos do Setor */
    .setor-lista-projetos {
      padding: 12px 16px;
      border-top: 1px solid rgba(255, 255, 255, 0.06);
      display: flex;
      flex-direction: column;
      gap: 6px;
      max-height: 200px;
      overflow-y: auto;
    }
    .setor-projeto-item {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 8px 10px;
      border-radius: 8px;
      font-size: 0.8rem;
      background: rgba(255, 255, 255, 0.04);
      cursor: pointer;
      transition: all 0.2s ease;
      color: #e7e5e4;
      border: 1px solid transparent;
    }
    .setor-projeto-item:hover {
      background: rgba(217, 119, 6, 0.15);
      border-color: rgba(217, 119, 6, 0.3);
      transform: translateX(4px);
    }
    .setor-projeto-item i {
      color: #d97706;
      font-size: 0.75rem;
    }

    /* Estilos para Chips de múltiplos responsáveis */
    .projeto-responsaveis, .etapa-responsaveis { 
      display: flex; 
      flex-wrap: wrap; 
      gap: 4px; 
      padding: 6px 10px; 
      background: var(--cor-primaria-bg); 
      border-radius: var(--raio-sm); 
      margin: 8px 0; 
    }
    
    .projeto-responsaveis.sem-responsavel {
      background: transparent;
      padding: 6px 0;
      color: var(--cor-texto-terciario);
      font-size: var(--tamanho-sm);
      display: flex;
      align-items: center;
      gap: 6px;
      font-style: italic;
    }

    .resp-chip { 
      display: inline-flex; 
      align-items: center; 
      gap: 4px; 
      padding: 2px 8px 2px 2px; 
      background: white; 
      border-radius: 12px; 
      font-size: var(--tamanho-xs); 
      border: 1px solid var(--cor-borda); 
    }

    .resp-chip.herdado { 
      background: transparent; 
      border-style: dashed; 
      opacity: 0.8; 
    }

    .resp-chip-avatar { 
      width: 18px; 
      height: 18px; 
      border-radius: 50%; 
      background: var(--cor-primaria); 
      color: white; 
      display: flex; 
      align-items: center; 
      justify-content: center; 
      font-size: 0.6rem; 
      font-weight: 600; 
    }

    .resp-chip-nome { 
      max-width: 80px; 
      overflow: hidden; 
      text-overflow: ellipsis; 
      white-space: nowrap; 
    }

    /* Nomes de responsáveis na etapa */
    .etapa-resp-nome { font-weight: 500; }
    .etapa-resp-nome.herdado { font-style: italic; opacity: 0.8; }
    .etapa-resp-nome small { font-size: 0.6rem; color: var(--cor-texto-terciario); margin-left: 2px; }
    .sem-responsavel { color: var(--cor-texto-terciario); font-style: italic; }

    .card-projeto { position: absolute; width: 280px; background: var(--cor-fundo-card); border-radius: var(--raio-lg); box-shadow: var(--sombra-md); overflow: visible; cursor: move; transition: box-shadow var(--transicao-media); z-index: var(--z-cards); }
    .card-projeto:hover { box-shadow: var(--sombra-lg); }
    .card-projeto.arrastando { opacity: 0.9; z-index: var(--z-arrastando); }
    .card-projeto.bloqueado-card { border: 2px solid var(--cor-aviso); }
    .projeto-barra-status { height: 5px; width: 100%; background: var(--cor-primaria); }
    .projeto-indicador-progresso { padding: 8px 12px; margin: 0; border-bottom: 1px solid var(--cor-borda); display: flex; flex-direction: column; gap: 6px; }
    .projeto-progresso-info { display: flex; align-items: center; gap: 8px; font-size: var(--tamanho-xs); font-weight: 600; }
    .projeto-progresso-info i { font-size: 0.9rem; }
    .projeto-progresso-barra { height: 6px; background: var(--cor-borda); border-radius: 3px; overflow: hidden; }
    .projeto-progresso-preenchimento { height: 100%; border-radius: 3px; transition: width 0.5s ease; }
    .projeto-conteudo { padding: var(--espacamento-md); }
    .projeto-header { display: flex; align-items: flex-start; gap: var(--espacamento-sm); margin-bottom: var(--espacamento-sm); }
    .projeto-icone { width: 36px; height: 36px; border-radius: var(--raio-md); background: var(--cor-primaria-bg); color: var(--cor-primaria); display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
    .projeto-titulo-wrap { flex: 1; min-width: 0; }
    .projeto-nome {font-family: var(--fonte-titulo);font-size: var(--tamanho-base);font-weight: 600;white-space: normal; overflow-wrap: anywhere; word-break: break-word;}
    .projeto-para-quem { font-size: var(--tamanho-xs); color: var(--cor-texto-terciario); }
    .projeto-prioridade { padding: 2px 8px; border-radius: var(--raio-sm); font-size: var(--tamanho-xs); font-weight: 600; text-transform: uppercase; }
    .projeto-prioridade.alta { background: rgba(220, 38, 38, 0.1); color: var(--cor-perigo); }
    .projeto-prioridade.media { background: rgba(202, 138, 4, 0.1); color: var(--cor-aviso); }
    .projeto-prioridade.baixa { background: rgba(101, 163, 13, 0.1); color: var(--cor-sucesso); }
    .projeto-link-container { margin-top: var(--espacamento-sm); padding-top: var(--espacamento-sm); border-top: 1px dashed var(--cor-borda); }
    .projeto-link-btn { display: inline-flex; align-items: center; gap: 6px; padding: 4px 10px; background: var(--cor-primaria-bg); color: var(--cor-primaria); border-radius: var(--raio-sm); font-size: var(--tamanho-xs); text-decoration: none; transition: var(--transicao-rapida); }
    .projeto-link-btn:hover { background: var(--cor-primaria); color: white; }
    .projeto-badges { display: flex; flex-wrap: wrap; gap: var(--espacamento-xs); margin-top: var(--espacamento-sm); }
    .projeto-badge { display: inline-flex; align-items: center; gap: 4px; padding: 3px 8px; border-radius: var(--raio-sm); font-size: var(--tamanho-xs); font-weight: 500; }
    .projeto-badge.total { background: var(--cor-primaria-bg); color: var(--cor-primaria); }
    .projeto-badge.pendentes { background: var(--status-em-andamento-bg); color: var(--status-em-andamento); }
    .projeto-badge.bloqueadas { background: var(--status-bloqueada-bg); color: var(--status-bloqueada); }
    .projeto-acoes { display: flex; flex-wrap: wrap; gap: var(--espacamento-xs); padding: var(--espacamento-sm) var(--espacamento-md); border-top: 1px solid var(--cor-borda); background: var(--cor-fundo); }
    .btn-projeto-acao { flex: 1; min-width: 50px; padding: 6px 8px; border: 1px solid var(--cor-borda); border-radius: var(--raio-sm); font-size: var(--tamanho-xs); cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 4px; background: var(--cor-fundo-card); color: var(--cor-texto-secundario); transition: var(--transicao-rapida); }
    .btn-projeto-acao:hover { background: var(--cor-primaria); color: white; border-color: var(--cor-primaria); }
    .btn-projeto-acao.expandir { flex: 2; background: var(--cor-primaria-bg); color: var(--cor-primaria); border-color: transparent; }
    .btn-projeto-acao.expandir.ativo { background: var(--cor-primaria); color: white; }
    .btn-projeto-acao.lock.locked { background: var(--cor-aviso); color: white; border-color: var(--cor-aviso); }
    .btn-projeto-acao.lock:hover { background: var(--cor-aviso); color: white; border-color: var(--cor-aviso); }
    .projeto-lista-etapas { margin-top: 10px; padding-top: 8px; border-top: 1px dashed var(--cor-borda); max-height: 0; overflow: hidden; opacity: 0; transition: max-height 0.3s ease, opacity 0.25s ease, padding 0.3s ease; display: flex; flex-direction: column; gap: 4px; }
    .projeto-lista-etapas.visivel { max-height: 400px; opacity: 1; padding-top: 8px; }
    .projeto-etapa-item { padding: 6px 8px; border-radius: 6px; font-size: 0.75rem; background: rgba(180, 83, 9, 0.08); cursor: pointer; transition: background 0.2s ease; display: flex; align-items: center; gap: 6px; }
    .projeto-etapa-item:hover { background: rgba(180, 83, 9, 0.2); transform: translateX(4px); }
    .projeto-etapa-item.nivel-1 { margin-left: 12px; }
    .projeto-etapa-item.nivel-2 { margin-left: 24px; }
    .projeto-etapa-item.nivel-3 { margin-left: 36px; }
    .projeto-info-setor { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 8px; font-size: 0.75rem; }
    .projeto-setor-link { display: inline-flex; align-items: center; gap: 5px; padding: 4px 10px; background: linear-gradient(135deg, rgba(68, 64, 60, 0.9), rgba(41, 37, 36, 0.9)); color: #e7e5e4; border-radius: var(--raio-sm); cursor: pointer; font-weight: 500; transition: all 0.2s ease; border: 1px solid transparent; }
    .projeto-setor-link:hover { background: linear-gradient(135deg, #44403c, #292524); border-color: var(--cor-primaria); transform: translateX(2px); box-shadow: 0 2px 8px rgba(180, 83, 9, 0.25); }
    .projeto-setor-link i:first-child { color: #d97706; font-size: 0.7rem; }
    .projeto-setor-link .indicador-nav { font-size: 0.6rem; opacity: 0; margin-left: -2px; transition: all 0.2s ease; }
    .projeto-setor-link:hover .indicador-nav { opacity: 1; margin-left: 4px; }
    .projeto-pilar { display: inline-flex; align-items: center; gap: 4px; padding: 4px 8px; background: var(--cor-primaria-bg); color: var(--cor-primaria); border-radius: var(--raio-sm); font-weight: 500; }
    .projeto-pilar i { font-size: 0.65rem; }

    .card-responsavel { position: absolute; width: 240px; background: var(--cor-fundo-card); border-radius: var(--raio-md); box-shadow: var(--sombra-sm); overflow: visible; cursor: move; z-index: var(--z-cards); border-left: 4px solid var(--cor-primaria); }
    .card-responsavel:hover { box-shadow: var(--sombra-md); }
    .card-responsavel.arrastando { opacity: 0.9; z-index: var(--z-arrastando); }
    .card-responsavel.bloqueado-card { border-color: var(--cor-aviso); }
    .card-responsavel.colapsado { opacity: 0.7; }
    .resp-header { display: flex; align-items: center; gap: var(--espacamento-sm); padding: var(--espacamento-sm) var(--espacamento-md); }
    .resp-avatar { width: 32px; height: 32px; border-radius: var(--raio-circular); background: linear-gradient(135deg, var(--cor-primaria) 0%, var(--cor-primaria-clara) 100%); color: white; display: flex; align-items: center; justify-content: center; font-size: var(--tamanho-xs); font-weight: 600; flex-shrink: 0; }
    .resp-info { flex: 1; min-width: 0; }
    .resp-nome { font-weight: 600; font-size: var(--tamanho-sm); overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
    .resp-cargo { font-size: var(--tamanho-xs); color: var(--cor-texto-terciario); }
    .resp-acoes { display: flex; gap: var(--espacamento-xs); padding: var(--espacamento-xs) var(--espacamento-sm); border-top: 1px solid var(--cor-borda); }
    .btn-resp-acao { flex: 1; padding: 4px; border: none; border-radius: var(--raio-sm); font-size: var(--tamanho-xs); cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 3px; background: transparent; color: var(--cor-texto-terciario); transition: var(--transicao-rapida); }
    .btn-resp-acao:hover { background: var(--cor-primaria-bg); color: var(--cor-primaria); }

    .card-etapa { 
        position: absolute; 
        min-width: 260px;
        max-width: 320px; 
        background: linear-gradient(135deg, var(--cor-fundo-card) 0%, var(--cor-status-etapa-bg, var(--cor-fundo-card)) 100%); 
        border-radius: var(--raio-lg); 
        box-shadow: var(--sombra-md); 
        overflow: visible; 
        cursor: pointer; 
        z-index: var(--z-etapas); 
        border-left: 4px solid var(--cor-primaria); 
        border-left-color: var(--cor-status-etapa, var(--cor-primaria)); 
        transition: box-shadow var(--transicao-media), border-color var(--transicao-media), background var(--transicao-media);
    }
    .card-etapa:hover { box-shadow: var(--sombra-lg); }
    .card-etapa.arrastando { opacity: 0.9; z-index: var(--z-arrastando); box-shadow: var(--sombra-xl); }
    .card-etapa.bloqueado-card { border-left-color: var(--cor-aviso); opacity: 0.8; }
    .card-etapa.expandida { min-width: 400px; }
    .card-etapa.nivel-1 { border-left-width: 3px; opacity: 0.95; }
    .card-etapa.nivel-2 { border-left-width: 2px; opacity: 0.9; }
    .card-etapa.nivel-3 { border-left-width: 2px; opacity: 0.85; font-size: 0.9em; }
    .card-etapa.status-concluida { background: linear-gradient(135deg, var(--cor-fundo-card) 0%, rgba(101, 163, 13, 0.08) 100%); }
    .card-etapa.status-em-andamento { background: linear-gradient(135deg, var(--cor-fundo-card) 0%, rgba(202, 138, 4, 0.08) 100%); }
    .card-etapa.status-bloqueada { background: linear-gradient(135deg, var(--cor-fundo-card) 0%, rgba(220, 38, 38, 0.08) 100%); }
    .card-etapa.status-a-fazer { background: linear-gradient(135deg, var(--cor-fundo-card) 0%, rgba(120, 113, 108, 0.05) 100%); }
    
    .card-etapa.arrastando, .card-etapa.movendo-hierarquia { transition: none !important; transform: none !important; }
    .arrastando-ativo .card-etapa, .arrastando-ativo .card-projeto, .arrastando-ativo .card-setor, .arrastando-ativo .card-responsavel { transition: none !important; }
    .arrastando-ativo .linha-padrao, .arrastando-ativo .linha-hierarquia-setor, .arrastando-ativo .linha-hierarquia-projeto, .arrastando-ativo .linha-hierarquia, .arrastando-ativo .linha-vinculo, .arrastando-ativo .linha-dependencia { transition: none !important; }

    .etapa-header { display: flex; align-items: center; justify-content: space-between; padding: var(--espacamento-sm) var(--espacamento-md); background: rgba(255, 255, 255, 0.5); border-bottom: 1px solid var(--cor-borda); gap: var(--espacamento-sm); }
    .etapa-header-left { display: flex; align-items: center; gap: var(--espacamento-sm); flex: 1; min-width: 0; }
    .btn-etapa-expandir { background: transparent; border: none; color: var(--cor-texto-terciario); cursor: pointer; padding: 4px; display: flex; align-items: center; justify-content: center; border-radius: var(--raio-sm); transition: var(--transicao-rapida); flex-shrink: 0; }
    .btn-etapa-expandir:hover { background: var(--cor-primaria-bg); color: var(--cor-primaria); }
    .btn-etapa-toggle-filhas { background: var(--cor-primaria-bg); color: var(--cor-primaria); border: none; cursor: pointer; padding: 4px 8px; border-radius: var(--raio-sm); font-size: var(--tamanho-xs); transition: var(--transicao-rapida); flex-shrink: 0; }
    .btn-etapa-toggle-filhas:hover { background: var(--cor-primaria); color: white; }
    .btn-etapa-toggle-filhas.colapsado { background: var(--cor-aviso); color: white; }
    
    .etapa-nome { 
      font-weight: 600; 
      font-size: var(--tamanho-sm); 
      color: var(--cor-texto); 
      flex: 1; 
      min-width: 0; 
      white-space: normal; 
      word-break: break-word; 
      line-height: 1.3;
    }
    .card-etapa:not(.expandida) .etapa-nome {
       white-space: nowrap;
       overflow: hidden;
       text-overflow: ellipsis;
    }

    .etapa-badges { display: flex; align-items: center; gap: 4px; flex-shrink: 0; }
    .etapa-badge-filhas { display: inline-flex; align-items: center; gap: 3px; padding: 2px 6px; background: var(--cor-primaria-bg); color: var(--cor-primaria); border-radius: var(--raio-sm); font-size: var(--tamanho-xs); font-weight: 600; }
    .etapa-badge-bloqueado { color: var(--cor-aviso); font-size: 0.7rem; }
    .etapa-status-badge { padding: 3px 10px; border-radius: 12px; font-size: var(--tamanho-xs); font-weight: 600; text-transform: uppercase; letter-spacing: 0.3px; white-space: nowrap; }
    .etapa-status-badge.concluida { background: rgba(101, 163, 13, 0.15); color: #65a30d; border: 1px solid rgba(101, 163, 13, 0.3); }
    .etapa-status-badge.em-andamento { background: rgba(202, 138, 4, 0.15); color: #ca8a04; border: 1px solid rgba(202, 138, 4, 0.3); }
    .etapa-status-badge.bloqueada { background: rgba(220, 38, 38, 0.15); color: #dc2626; border: 1px solid rgba(220, 38, 38, 0.3); }
    .etapa-status-badge.a-fazer { background: rgba(120, 113, 108, 0.12); color: #78716c; border: 1px solid rgba(120, 113, 108, 0.3); }
    .etapa-projeto-link { display: flex; align-items: center; gap: 6px; padding: 6px 10px; margin: 0; background: linear-gradient(135deg, rgba(68, 64, 60, 0.95), rgba(41, 37, 36, 0.95)); color: #e7e5e4; font-size: var(--tamanho-xs); font-weight: 500; cursor: pointer; transition: all 0.2s ease; border-bottom: 1px solid var(--cor-borda); }
    .etapa-projeto-link:hover { background: linear-gradient(135deg, #44403c, #292524); padding-left: 14px; }
    .etapa-projeto-link i:first-child { color: #d97706; font-size: 0.7rem; }
    .etapa-projeto-link span { flex: 1; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
    .indicador-nav-projeto { font-size: 0.6rem; opacity: 0; margin-left: auto; transition: all 0.2s ease; }
    .etapa-projeto-link:hover .indicador-nav-projeto { opacity: 1; }
    .etapa-resumo { padding: var(--espacamento-sm) var(--espacamento-md); display: flex; flex-direction: column; gap: 6px; }
    .etapa-resumo-linha { display: flex; align-items: center; gap: 6px; font-size: var(--tamanho-xs); color: var(--cor-texto-secundario); }
    .etapa-resumo-linha i { color: var(--cor-primaria); width: 14px; text-align: center; flex-shrink: 0; }
    .etapa-resumo-texto { overflow: hidden; text-overflow: ellipsis; white-space: nowrap; flex: 1; }
    
    .etapa-corpo { max-height: 0; overflow: hidden; opacity: 0; padding: 0 var(--espacamento-md); border-top: 1px solid transparent; background: var(--cor-fundo); transition: max-height 0.15s ease-out, opacity 0.12s ease, padding 0.15s ease, border-color 0.15s ease; }
    .card-etapa.calculando-altura .etapa-corpo { transition: none !important; max-height: 600px !important; opacity: 1 !important; padding: var(--espacamento-md) !important; }
    .card-etapa.expandida .etapa-corpo { max-height: 600px; opacity: 1; padding: var(--espacamento-md); border-top-color: var(--cor-borda); }
    .etapa-campo { margin-bottom: var(--espacamento-md); }
    .etapa-campo:last-child { margin-bottom: 0; }
    .etapa-campo-label { font-size: var(--tamanho-xs); color: var(--cor-texto-terciario); font-weight: 600; text-transform: uppercase; margin-bottom: 4px; display: flex; align-items: center; gap: 4px; }
    .etapa-campo-valor { font-size: var(--tamanho-sm); color: var(--cor-texto-secundario); line-height: 1.5; white-space: pre-wrap; word-break: break-word; }
    .etapa-campo-vazio { font-style: italic; opacity: 0.6; }
    .etapa-pendencias-bloco { background: var(--status-bloqueada-bg); border-left: 3px solid var(--cor-perigo); padding: var(--espacamento-sm); border-radius: 0 var(--raio-sm) var(--raio-sm) 0; margin-top: var(--espacamento-sm); }
    .etapa-pendencias-bloco .etapa-campo-label { color: var(--cor-perigo); }
    .etapa-acoes { display: none; justify-content: flex-end; gap: var(--espacamento-xs); padding: var(--espacamento-sm) var(--espacamento-md); border-top: 1px dashed var(--cor-borda); background: var(--cor-fundo-card); flex-wrap: wrap; }
    .card-etapa.expandida .etapa-acoes { display: flex; }
    .btn-etapa-acao { padding: 6px 12px; border: none; border-radius: var(--raio-sm); font-size: var(--tamanho-xs); font-weight: 500; cursor: pointer; display: flex; align-items: center; gap: 4px; transition: var(--transicao-rapida); }
    .btn-etapa-acao.editar { background: var(--cor-primaria-bg); color: var(--cor-primaria); }
    .btn-etapa-acao.editar:hover { background: var(--cor-primaria); color: white; }
    .btn-etapa-acao.excluir { background: var(--status-bloqueada-bg); color: var(--cor-perigo); }
    .btn-etapa-acao.excluir:hover { background: var(--cor-perigo); color: white; }
    .btn-etapa-acao.sub-etapa { background: var(--cor-sucesso); color: white; }
    .btn-etapa-acao.sub-etapa:hover { background: #4d7c0f; }
    .card-deslocando { z-index: calc(var(--z-arrastando) - 1); box-shadow: var(--sombra-lg); }
    .tem-filhos-movendo { box-shadow: var(--sombra-xl), 0 0 0 3px rgba(180, 83, 9, 0.4); }
    .tem-filhos-movendo::after { content: ''; position: absolute; top: -5px; left: -5px; right: -5px; bottom: -5px; border: 2px dashed var(--cor-primaria); border-radius: calc(var(--raio-lg) + 3px); pointer-events: none; animation: pulseHierarquia 1s ease infinite; }

    /* ========== BOTÃO DE DETALHES DO PROJETO - COM ANIMAÇÃO ========== */
    .btn-projeto-detalhe {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      width: 100%;
      padding: 10px 16px;
      margin-top: 12px;
      background: linear-gradient(135deg, var(--cor-primaria) 0%, var(--cor-primaria-hover) 100%);
      color: white;
      border: none;
      border-radius: 10px;
      font-family: var(--fonte-corpo);
      font-size: var(--tamanho-sm);
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      box-shadow: 0 4px 12px rgba(180, 83, 9, 0.25);
      position: relative;
      overflow: hidden;
    }

    .btn-projeto-detalhe:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(180, 83, 9, 0.35);
    }

    .btn-projeto-detalhe:active {
      transform: translateY(0);
    }

    .btn-projeto-detalhe i {
      font-size: 0.85rem;
      transition: transform 0.3s ease;
    }

    /* ========== ANIMAÇÃO DE CLIQUE NO BOTÃO DETALHES ========== */
    @keyframes pulsoSaida {
      0% {
        transform: scale(1);
        box-shadow: 0 4px 12px rgba(180, 83, 9, 0.25);
      }
      30% {
        transform: scale(0.96);
        box-shadow: 0 2px 8px rgba(180, 83, 9, 0.4);
      }
      100% {
        transform: scale(1.02);
        box-shadow: 0 0 0 4px rgba(217, 119, 6, 0.3), 0 6px 20px rgba(180, 83, 9, 0.35);
      }
    }

    @keyframes iconeGirar {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    @keyframes ondaExpansao {
      0% {
        transform: scale(0);
        opacity: 0.6;
      }
      100% {
        transform: scale(2.5);
        opacity: 0;
      }
    }

    .btn-projeto-detalhe.animando-saida {
      animation: pulsoSaida 0.4s ease forwards;
      pointer-events: none;
    }

    .btn-projeto-detalhe.animando-saida::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 100%;
      height: 100%;
      background: rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      transform: translate(-50%, -50%) scale(0);
      animation: ondaExpansao 0.5s ease-out;
    }

    .btn-projeto-detalhe.animando-saida i {
      animation: iconeGirar 0.4s ease-out;
    }

/* ========== BADGES DE PRIORIDADE ========== */
.badge-prioridade {
  position: absolute;
  top: -8px;
  right: -8px;
  min-width: 28px;
  height: 28px;
  padding: 0 6px;
  background: var(--cor-primaria);
  color: white;
  border-radius: 14px;
  font-size: 11px;
  font-weight: 700;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 2px 8px rgba(180, 83, 9, 0.4);
  z-index: 15;
  border: 2px solid white;
}
.badge-prioridade.prioridade-1 {
  background: linear-gradient(135deg, #dc2626, #b91c1c);
  box-shadow: 0 2px 8px rgba(220, 38, 38, 0.5);
}
.badge-prioridade.prioridade-2 {
  background: linear-gradient(135deg, #ea580c, #c2410c);
}
.badge-prioridade.prioridade-3 {
  background: linear-gradient(135deg, #ca8a04, #a16207);
}

/* Badge de prioridade para etapas */
.badge-prioridade-etapa {
  background: var(--cor-primaria);
  color: white;
  padding: 2px 8px;
  border-radius: 10px;
  font-size: 10px;
  font-weight: 700;
  margin-right: 4px;
}

</style>